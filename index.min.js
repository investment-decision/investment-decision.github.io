const MODAL_DATA={macro:{title:"Macro Regime Composite",body:'\n                    <p>Visualizes the four economic seasons based on Growth and Inflation. The current regime is determined by the dot\'s position.</p>\n                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; font-size:0.9em; text-align:center;">\n                        <div style="background:#fff3e0; padding:10px; border-radius:6px; border:1px solid #ffe0b2;">\n                            <strong style="color:#e65100;">Overheat (Q1)</strong><br>\n                            <span style="font-size:0.8em; color:#666;">Growth↑ Inflation↑</span><br>\n                            <span style="color:#ef6c00; font-weight:600;">Commodities/Value</span>\n                        </div>\n                        <div style="background:#ffebee; padding:10px; border-radius:6px; border:1px solid #ffcdd2;">\n                            <strong style="color:#c62828;">Stagflation (Q2)</strong><br>\n                            <span style="font-size:0.8em; color:#666;">Growth↓ Inflation↑</span><br>\n                            <span style="color:#d32f2f; font-weight:600;">Cash/Gold</span>\n                        </div>\n                        <div style="background:#e3f2fd; padding:10px; border-radius:6px; border:1px solid #bbdefb;">\n                            <strong style="color:#1565c0;">Deflation (Q3)</strong><br>\n                            <span style="font-size:0.8em; color:#666;">Growth↓ Inflation↓</span><br>\n                            <span style="color:#1976d2; font-weight:600;">Bonds/USD</span>\n                        </div>\n                        <div style="background:#e8f5e9; padding:10px; border-radius:6px; border:1px solid #c8e6c9;">\n                            <strong style="color:#2e7d32;">Reflation (Q4)</strong><br>\n                            <span style="font-size:0.8em; color:#666;">Growth↑ Inflation↓</span><br>\n                            <span style="color:#388e3c; font-weight:600;">Growth Stocks</span>\n                        </div>\n                    </div>'},liquidity:{title:"Global Net Liquidity Gauge",body:"\n                    <p>Measures the net liquidity available in the market by subtracting liabilities (TGA, RRP) from the Fed's total assets.</p>\n                    <p><strong>Formula:</strong> Fed Assets - TGA - RRP</p>\n                    <ul>\n                        <li><strong>Rising:</strong> Increased liquidity, favoring risk assets (stocks, crypto).</li>\n                        <li><strong>Falling:</strong> Tightening liquidity, potential for market correction.</li>\n                    </ul>"},sentiment:{title:"Composite Sentiment Oscillator",body:"<p>Measures market fear and greed on a scale of 0 to 100.</p>\n                       <ul>\n                           <li><strong>0-20 (Extreme Fear):</strong> Market panic. Potential contrarian buy signal.</li>\n                           <li><strong>80-100 (Extreme Greed):</strong> Market euphoria. Consider taking profits.</li>\n                           <li><strong>Components:</strong> VIX, Put/Call Ratio, Junk Bond Spread, Momentum, Safe Haven Demand.</li>\n                       </ul>"},leading:{title:"Inter-Market Leading Indicator",body:'<p>Predicts future market direction using "smart money" signals from bond and commodity markets.</p>\n                       <ul>\n                           <li><strong>Copper/Gold Ratio:</strong> Economic recovery vs. fear.</li>\n                           <li><strong>Yield Curve (10Y-2Y):</strong> Recession warning when inverted.</li>\n                           <li><strong>High Beta/Low Vol:</strong> Internal market risk appetite.</li>\n                       </ul>'},pmi:{title:"Z_PMI (ISM Manufacturing)",body:"<p>A leading indicator of economic health based on surveys of purchasing managers. 'New Orders' specifically leads the equity market cycle.</p>"},ratio:{title:"Z_Ratio (Cyclical vs Defensive)",body:"<p>The relative performance of Cyclical vs. Defensive stocks. Reflects real-time economic growth expectations from market participants.</p>"},t5yifr:{title:"Z_T5YIFR (5Y Inflation Exp)",body:"<p>The market's expectation for inflation over the 5-year period beginning 5 years from today. Filters out short-term oil price noise.</p>"},commodity:{title:"Z_Commodity (Broad Index)",body:"<p>Broad commodity index (Energy, Metals, Agriculture). A leading indicator for consumer price inflation (CPI).</p>"},mom:{title:"Momentum Score",body:"<p>Distance between current price and the 125-day moving average. Higher values indicate Greed.</p>"},vix:{title:"VIX Score",body:"<p>Volatility Index. Higher values indicate Fear (resulting in a lower score).</p>"},pc:{title:"Put/Call Score",body:"<p>Put/Call Ratio. Higher values indicate Fear (resulting in a lower score).</p>"},safe:{title:"Safe Haven Score",body:"<p>Return difference between Stocks and Bonds. Outperformance of stocks indicates Greed.</p>"},junk:{title:"Junk Bond Score",body:"<p>High Yield Bond Spread. Widening spreads indicate Fear (resulting in a lower score).</p>"},cg:{title:"Z_Copper/Gold",body:"<p>Copper (Growth) to Gold (Fear) ratio. Rising trend signals economic recovery.</p>"},bv:{title:"Z_Beta/Volatility",body:"<p>Ratio of High Beta to Low Volatility stocks. Indicates internal market risk appetite.</p>"},ys:{title:"Z_Yield Spread",body:"<p>Yield Curve Spread (10Y-2Y). Inversion (negative value) warns of an impending recession.</p>"}};function openModal(e){const t=MODAL_DATA[e];t&&(document.getElementById("modalTitle").innerHTML=t.title,document.getElementById("modalBody").innerHTML=t.body,document.getElementById("infoModal").style.display="flex")}function closeModal(){document.getElementById("infoModal").style.display="none"}async function createCharts(){try{const e=await fetch("./data/market_indices.json");if(!e.ok)throw new Error("Network response was not ok");const t=await e.json(),i=t.map((e=>e[0])),o={responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!1}},scales:{x:{display:!0,ticks:{maxTicksLimit:6,font:{size:10},callback:function(e){return this.getLabelForValue(e).substring(0,7)}},grid:{display:!1}},y:{grid:{color:"#f0f0f0"}}},elements:{point:{radius:0,hoverRadius:4}}},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{min:-3,max:3,grid:{color:e=>0===e.tick.value?"#333":"#eee",lineWidth:e=>0===e.tick.value?1.5:1}},y:{min:-3,max:3,grid:{color:e=>0===e.tick.value?"#333":"#eee",lineWidth:e=>0===e.tick.value?1.5:1}}}},r={responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!1}},scales:{x:{display:!0,ticks:{maxTicksLimit:6,font:{size:10},callback:function(e){return this.getLabelForValue(e).substring(0,7)}},grid:{display:!1}},y:{min:0,max:100,grid:{color:"#f0f0f0"},ticks:{stepSize:20}}},elements:{point:{radius:0,hoverRadius:4}}},a=60,l=t.slice(-a),s=l.map((e=>({x:e[1],y:e[2]}))),d=s.slice(0,-1).map(((e,t,i)=>`rgba(100, 110, 120, ${.1+t/i.length*.9})`)),c=l[0][0],p=l[l.length-2][0],f={id:"quadrantLabels",afterDraw:e=>{const{ctx:t,chartArea:{left:i,right:o,top:n,bottom:r,width:a,height:l},scales:{x:s,y:d}}=e,c=s.getPixelForValue(0),p=d.getPixelForValue(0);t.save(),t.font="bold 12px Inter",t.fillStyle="rgba(150, 150, 150, 0.4)",t.textAlign="center",t.textBaseline="middle";const f=(c+o)/2,g=(n+p)/2,m=(i+c)/2,u=(n+p)/2,y=(i+c)/2,b=(p+r)/2,h=(c+o)/2,v=(p+r)/2;t.fillText("OVERHEAT",f,g),t.fillText("STAGFLATION",m,u),t.fillText("DEFLATION",y,b),t.fillText("REFLATION",h,v),t.restore()}};new Chart(document.getElementById("chartMacro"),{type:"scatter",data:{datasets:[{label:`${c} ~ ${p}`,data:s.slice(0,-1),backgroundColor:d,borderColor:d,pointRadius:3,pointHoverRadius:5},{label:"Current",data:[s[s.length-1]],backgroundColor:"#e74c3c",borderColor:"#ffffff",borderWidth:2,pointRadius:7,pointHoverRadius:9}]},options:n,plugins:[f]}),new Chart(document.getElementById("chartLiquidity"),{type:"line",data:{labels:i,datasets:[{data:t.map((e=>e[3])),borderColor:"#af52de",borderWidth:2,fill:!1,tension:.3}]},options:o}),new Chart(document.getElementById("chartSentiment"),{type:"line",data:{labels:i,datasets:[{data:t.map((e=>e[4])),borderColor:"#ff9500",borderWidth:2,fill:!1,tension:.3},{data:Array(i.length).fill(80),borderColor:"rgba(231, 76, 60, 0.3)",borderWidth:1,borderDash:[5,5],pointRadius:0,fill:!1},{data:Array(i.length).fill(20),borderColor:"rgba(46, 204, 113, 0.3)",borderWidth:1,borderDash:[5,5],pointRadius:0,fill:!1}]},options:r}),new Chart(document.getElementById("chartLeading"),{type:"line",data:{labels:i,datasets:[{data:t.map((e=>e[5])),borderColor:"#34c759",borderWidth:2,fill:!1,tension:.3}]},options:o});const g=(e,n,r,a=o)=>{new Chart(document.getElementById(e),{type:"line",data:{labels:i,datasets:[{data:t.map((e=>e[n])),borderColor:r,borderWidth:1.5,fill:!1,tension:.1}]},options:a})};g("chartPmi",6,"#007aff"),g("chartRatio",7,"#007aff"),g("chartT5yifr",8,"#ff3b30"),g("chartCommodity",9,"#ff3b30"),g("chartSentMom",11,"#ff9500",r),g("chartSentVix",12,"#ff9500",r),g("chartSentPC",13,"#ff9500",r),g("chartSentSafe",14,"#ff9500",r),g("chartSentJunk",15,"#ff9500",r),g("chartLeadCG",16,"#34c759"),g("chartLeadBV",17,"#34c759"),g("chartLeadYS",18,"#34c759")}catch(e){console.error("Error:",e)}}createCharts();