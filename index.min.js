async function createCharts(){try{const t=await fetch('./data/market_indices.json');if(!t.ok)throw new Error('Network response was not ok');const e=await t.json();if(e.length>0){const t=e[e.length-1][0];document.getElementById('last-updated').textContent=`Last updated: ${t}`}const a=e.map(t=>t[0]),i={responsive:!0,maintainAspectRatio:!1,interaction:{mode:'index',intersect:!1},plugins:{legend:{display:!1}},scales:{x:{display:!0,ticks:{maxTicksLimit:6,font:{size:10},callback:function(t){const e=this.getLabelForValue(t);return e&&e.endsWith('-01')?e.substring(0,7):null}},grid:{display:!1}},y:{grid:{color:'#f0f0f0'}}},elements:{point:{radius:0,hoverRadius:4}}},n={responsive:!0,maintainAspectRatio:!1,interaction:{mode:'point',intersect:!0},plugins:{legend:{display:!1},tooltip:{filter:function(t,e){return 0===e},callbacks:{title:t=>{const e=t?.[0]?.raw;return e?.date??''},label:t=>{const{x:e,y:a}=t.raw||{};return`Growth: ${'number'==typeof e?e.toFixed(2):e}, Inflation: ${'number'==typeof a?a.toFixed(2):a}`}}}},scales:{x:{min:-3,max:3,grid:{color:t=>0===t.tick.value?'#333':'#eee',lineWidth:t=>0===t.tick.value?1.5:1}},y:{min:-3,max:3,grid:{color:t=>0===t.tick.value?'#333':'#eee',lineWidth:t=>0===t.tick.value?1.5:1}}}},r={responsive:!0,maintainAspectRatio:!1,interaction:{mode:'index',intersect:!1},plugins:{legend:{display:!1}},scales:{x:{display:!0,ticks:{maxTicksLimit:6,font:{size:10},callback:function(t){const e=this.getLabelForValue(t);return e&&e.endsWith('-01')?e.substring(0,7):null}},grid:{display:!1}},y:{min:0,max:100,grid:{color:'#f0f0f0'},ticks:{stepSize:20}}},elements:{point:{radius:0,hoverRadius:4}}},o=60,l=e.slice(-o),d=l.map(t=>({x:t[1],y:t[2],date:t[0]})),s=d.slice(0,-1).map((t,e,a)=>`rgba(100, 110, 120, ${.1+e/a.length*.9})`),c=l[0][0],f=l[l.length-2][0],h={id:'quadrantLabels',afterDraw:t=>{const{ctx:e,chartArea:{left:a,right:i,top:n,bottom:r,width:o,height:l},scales:{x:d,y:s}}=t,c=d.getPixelForValue(0),f=s.getPixelForValue(0);e.save(),e.font='bold 12px Inter',e.fillStyle='rgba(150, 150, 150, 0.4)',e.textAlign='center',e.textBaseline='middle';const h=(c+i)/2,u=(n+f)/2,p=(a+c)/2,m=(n+f)/2,b=(a+c)/2,g=(f+r)/2,y=(c+i)/2,x=(f+r)/2;e.fillText('OVERHEAT',h,u),e.fillText('STAGFLATION',p,m),e.fillText('DEFLATION',b,g),e.fillText('REFLATION',y,x),e.restore()}};new Chart(document.getElementById('chartMacro'),{type:'scatter',data:{datasets:[{label:`${c} ~ ${f}`,data:d.slice(0,-1),backgroundColor:s,borderColor:s,pointRadius:3,pointHoverRadius:5},{label:'Current',data:[d[d.length-1]],backgroundColor:'#e74c3c',borderColor:'#ffffff',borderWidth:2,pointRadius:7,pointHoverRadius:9}]},options:n,plugins:[h]}),new Chart(document.getElementById('chartLiquidity'),{type:'line',data:{labels:a,datasets:[{data:e.map(t=>t[3]),borderColor:'#af52de',borderWidth:2,fill:!1,tension:.3}]},options:i}),new Chart(document.getElementById('chartSentiment'),{type:'line',data:{labels:a,datasets:[{data:e.map(t=>t[4]),borderColor:'#ff9500',borderWidth:2,fill:!1,tension:.3},{data:Array(a.length).fill(80),borderColor:'rgba(231, 76, 60, 0.3)',borderWidth:1,borderDash:[5,5],pointRadius:0,fill:!1},{data:Array(a.length).fill(20),borderColor:'rgba(46, 204, 113, 0.3)',borderWidth:1,borderDash:[5,5],pointRadius:0,fill:!1}]},options:r}),new Chart(document.getElementById('chartLeading'),{type:'line',data:{labels:a,datasets:[{data:e.map(t=>t[5]),borderColor:'#34c759',borderWidth:2,fill:!1,tension:.3}]},options:i});const u=(t,n,r,o=i)=>{new Chart(document.getElementById(t),{type:'line',data:{labels:a,datasets:[{data:e.map(t=>t[n]),borderColor:r,borderWidth:1.5,fill:!1,tension:.1}]},options:o})};u('chartPmi',6,'#007aff'),u('chartRatio',7,'#007aff'),u('chartT5yifr',8,'#ff3b30'),u('chartCommodity',9,'#ff3b30'),u('chartSentMom',11,'#ff9500',r),u('chartSentVix',12,'#ff9500',r),u('chartSentSafe',14,'#ff9500',r),u('chartSentJunk',15,'#ff9500',r),u('chartLeadCG',16,'#34c759'),u('chartLeadBV',17,'#34c759'),u('chartLeadYS',18,'#34c759')}catch(t){}}'loading'===document.readyState?document.addEventListener('DOMContentLoaded',createCharts):createCharts();
